language: cpp

env:
  global:
    - ARDUINO_VERSION="1.6.6"
    - ARDUINO_PATH="./arduino-$(eval echo $ARDUINO_VERSION)"
    - ARDUINO="$(eval echo $ARDUINO_PATH)/arduino"
  matrix:
    - PLATFORM='arduino:avr'  BOARD='uno'
    - PLATFORM='arduino:avr'  BOARD='mega:cpu=atmega2560'
    - PLATFORM='arduino:avr'  BOARD='leonardo'
    - PLATFORM='arduino:sam'  BOARD='arduino_due_x_dbg'
#   - PLATFORM='arduino:samd' BOARD='arduino_zero_edbg'
    - PLATFORM='Intel:i586'   BOARD='izmir_fd'
    - PLATFORM='Intel:i586'   BOARD='izmir_fg'

before_install:
  - "/sbin/start-stop-daemon --start --quiet --pidfile /tmp/custom_xvfb_1.pid --make-pidfile --background --exec /usr/bin/Xvfb -- :1 -ac -screen 0 1280x1024x16"
  - sleep 3
  - export DISPLAY=:1.0
  - wget http://downloads.arduino.cc/arduino-$(eval echo $ARDUINO_VERSION)-linux64.tar.xz
  - tar xf arduino-$(eval echo $ARDUINO_VERSION)-linux64.tar.xz
  - mkdir build
  - $ARDUINO --install-boards $PLATFORM > /dev/null

install:
  - ln -s $PWD $ARDUINO_PATH/libraries/OneSheeld

before_script:
  - $ARDUINO --pref build.path=$PWD/build --board $PLATFORM:$BOARD --save-prefs

script:
  - $ARDUINO --verify $PWD/examples/Advanced/Accelerometer/Accelerometer.ino
  - $ARDUINO --verify $PWD/examples/Advanced/Buzzer/Buzzer.ino
  - $ARDUINO --verify $PWD/examples/Advanced/Camera/Camera.ino
  - $ARDUINO --verify $PWD/examples/Advanced/Clock/Clock.ino
  - $ARDUINO --verify $PWD/examples/Advanced/Color/Color.ino
  - $ARDUINO --verify $PWD/examples/Advanced/Email/Email.ino
  - $ARDUINO --verify $PWD/examples/Advanced/Facebook/Facebook.ino
  - $ARDUINO --verify $PWD/examples/Advanced/Foursquare/Foursquare.ino
  - $ARDUINO --verify $PWD/examples/Advanced/GamePad/GamePad.ino
  - $ARDUINO --verify $PWD/examples/Advanced/GLCD/GLCD.ino
  - $ARDUINO --verify $PWD/examples/Advanced/GPS/GPS.ino
  - $ARDUINO --verify $PWD/examples/Advanced/Gravity/Gravity.ino
  - $ARDUINO --verify $PWD/examples/Advanced/Internet/Internet.ino
  - $ARDUINO --verify $PWD/examples/Advanced/Keypad/Keypad.ino
  - $ARDUINO --verify $PWD/examples/Advanced/LCD/LCD.ino
  - $ARDUINO --verify $PWD/examples/Advanced/Light/Light.ino
  - $ARDUINO --verify $PWD/examples/Advanced/Magnetometer/Magnetometer.ino
  - $ARDUINO --verify $PWD/examples/Advanced/Mic/Mic.ino
  - $ARDUINO --verify $PWD/examples/Advanced/MusicPlayer/MusicPlayer.ino
  - $ARDUINO --verify $PWD/examples/Advanced/NFC/NFC.ino
  - $ARDUINO --verify $PWD/examples/Advanced/Notification/Notification.ino
  - $ARDUINO --verify $PWD/examples/Advanced/Orientation/Orientation.ino
  - $ARDUINO --verify $PWD/examples/Advanced/Phone/Phone.ino
  - $ARDUINO --verify $PWD/examples/Advanced/Pressure/Pressure.ino
  - $ARDUINO --verify $PWD/examples/Advanced/Proximity/Proximity.ino
  - $ARDUINO --verify $PWD/examples/Advanced/SevenSegment/SevenSegment.ino
  - $ARDUINO --verify $PWD/examples/Advanced/Skype/Skype.ino
  - $ARDUINO --verify $PWD/examples/Advanced/SMS/SMS.ino
  - $ARDUINO --verify $PWD/examples/Advanced/TextToSpeech/TextToSpeech.ino
  - $ARDUINO --verify $PWD/examples/Advanced/ToggleButton/ToggleButton.ino
  - $ARDUINO --verify $PWD/examples/Advanced/Twitter/Twitter.ino
  - $ARDUINO --verify $PWD/examples/Advanced/VoiceRecognition/VoiceRecognition.ino
  - $ARDUINO --verify $PWD/examples/Simple/Accelerometer/Accelerometer.ino
  - $ARDUINO --verify $PWD/examples/Simple/Buzzer/Buzzer.ino
  - $ARDUINO --verify $PWD/examples/Simple/Camera/Camera.ino
  - $ARDUINO --verify $PWD/examples/Simple/Color/Color.ino
  - $ARDUINO --verify $PWD/examples/Simple/DataLogger/DataLogger.ino
  - $ARDUINO --verify $PWD/examples/Simple/Facebook/Facebook.ino
  - $ARDUINO --verify $PWD/examples/Simple/Foursquare/Foursquare.ino
  - $ARDUINO --verify $PWD/examples/Simple/GamePad/GamePad.ino
  - $ARDUINO --verify $PWD/examples/Simple/GLCD/GLCD.ino
  - $ARDUINO --verify $PWD/examples/Simple/Gravity/Gravity.ino
  - $ARDUINO --verify $PWD/examples/Simple/Gyroscope/Gyroscope.ino
  - $ARDUINO --verify $PWD/examples/Simple/Internet/Internet.ino
  - $ARDUINO --verify $PWD/examples/Simple/Keyboard/Keyboard.ino
  - $ARDUINO --verify $PWD/examples/Simple/Keypad/Keypad.ino
  - $ARDUINO --verify $PWD/examples/Simple/Led/Led.ino
  - $ARDUINO --verify $PWD/examples/Simple/Light/Light.ino
  - $ARDUINO --verify $PWD/examples/Simple/Magnetometer/Magnetometer.ino
  - $ARDUINO --verify $PWD/examples/Simple/Mic/Mic.ino
  - $ARDUINO --verify $PWD/examples/Simple/MusicPlayer/MusicPlayer.ino
  - $ARDUINO --verify $PWD/examples/Simple/NFC/NFC.ino
  - $ARDUINO --verify $PWD/examples/Simple/Notification/Notification.ino
  - $ARDUINO --verify $PWD/examples/Simple/Orientation/Orientation.ino
  - $ARDUINO --verify $PWD/examples/Simple/Pattern/Pattern.ino
  - $ARDUINO --verify $PWD/examples/Simple/Phone/Phone.ino
  - $ARDUINO --verify $PWD/examples/Simple/Proximity/Proximity.ino
  - $ARDUINO --verify $PWD/examples/Simple/PushButton/PushButton.ino
  - $ARDUINO --verify $PWD/examples/Simple/Slider/Slider.ino
  - $ARDUINO --verify $PWD/examples/Simple/Temperature/Temperature.ino
  - $ARDUINO --verify $PWD/examples/Simple/Terminal/Terminal.ino
  - $ARDUINO --verify $PWD/examples/Simple/Twitter/Twitter.ino
  - $ARDUINO --verify $PWD/examples/Simple/VoiceRecognition/VoiceRecognition.ino
#  - for example in $PWD/examples/*/*/*.ino; do arduino --verify $example; done;
#  - find $PWD/examples -type f -name "*.ino" -exec arduino --verify {} \; 

notifications:
  email:
    on_success: change
    on_failure: change